<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timothy Simons - Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        #terrain-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        .header-content {
            position: relative;
            z-index: 10;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    
    <!-- Header Section -->
    <header class="bg-white border-b border-gray-200 relative overflow-hidden">
        <canvas id="terrain-canvas"></canvas>

        <div class="absolute top-4 left-4 z-20">
            <img src="static/corpernicus.png" alt="Logo" class="h-16 w-auto object-contain">
            <img src="static/plus.png" alt="Logo" class="pl-5 pb-3 h-16 space-y-4 h-12 w-auto object-contain">
            <img src="static/ubs.png" alt="Logo" class="pl-5 h-14 w-auto object-contain">
        </div>
         
        <div class="absolute bottom-4 right-4 z-20 group">
            <button
                class="bg-white/80 backdrop-blur-sm border border-teal-400 rounded-full w-8 h-8 flex items-center justify-center hover:bg-white transition">
                <span class="text-gray-600 text-sm font-medium">?</span>
            </button>
            <div
                class="hidden group-hover:block absolute right-0 bottom-full mb-2 w-64 p-3
                    bg-white border border-gray-300 rounded-lg shadow-lg
                    text-sm text-gray-700 leading-relaxed">
            <p>
                <strong class="text-gray-900">3D Untersberg Visualisation</strong><br>
                The Untersberg <a href="https://en.wikipedia.org/wiki/Massif" target="_blank">massif</a> has been a prominent part of my time in Salzburg, Austria.  
                Shown here is a 3D heightmap of the nearest peak (visualised with <a href="https://threejs.org/" target="_blank">three.js</a>)
            </p>
            </div>
        </div>
        
        <div class="max-w-5xl mx-auto px-6 py-16 text-center header-content">
            <div class="mb-6">
                <img src="static/profile.png" alt="Profile Picture" class="w-32 h-32 rounded-full mx-auto border-4 border-white shadow-lg object-cover" style="object-position: center 30%;">
            </div>
            <h1 class="text-4xl md:text-5xl tracking-tight mb-3 text-gray-900 text-shadow-strong" style="text-shadow: 0 2px 12px rgba(255, 255, 255, 0.9), 0 4px 24px rgba(255, 255, 255, 0.9), 0 0 40px rgba(255, 255, 255, 0.9);">Timothy Simons</h1>
            <p class="text-gray-800 text-lg font-medium text-shadow-strong" style="text-shadow: 0 2px 8px rgba(255, 255, 255, 0.9), 0 4px 16px rgba(255, 255, 255, 0.7);">Software Engineer & Geoinformatics Student</p>
        </div>
    </header>

    <!-- About Me Section -->
    <section class="max-w-5xl mx-auto px-6 py-16 border-b border-gray-200">
        <h2 class="text-2xl font-light mb-6 text-gray-900">About Me</h2>
        <div class="prose prose-lg max-w-none">
            <p class="text-gray-700 leading-relaxed mb-4">
                I am a software engineer and geoinformatics student with a strong background in computer vision and software infrastructure.
            </p>
            <p class="text-gray-700 leading-relaxed mb-4">
                My focus lies at the intersection of these fields, combining computer vision with Geographic Information Systems (GIS) to build software that helps interpret and understand spatial data in new and meaningful ways.
            </p>
            <p class="text-gray-700 leading-relaxed">
                As a student at PLUS, I live on the outskirts of Salzburg near the Untersberg massif. Sure, my commute can feel long at times, but I'm lucky enough to have countless hiking trails just steps from my door.
                The rotating visualisation above is a part of the Untersberg that I wake up to each morning. 
            </p>
        </div>
    </section>

    <section class="max-w-5xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-light mb-10 text-gray-900">Selected Coursework</h2>
        
        <div class="grid md:grid-cols-2 gap-8">
            <!-- Project 1 -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
                <div class="aspect-video bg-gray-200">
                    <img src="static/unw.png" alt="IN PROGRESS" class="w-full h-full object-cover">
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-medium mb-1 text-gray-900">Ridgecrest Earthquake Surface Deformation Analysis</h3>
                    <p class="text-sm text-gray-500 mb-4">Advanced Remote Sensing</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">
                        This project uses Sentinel-1 Interferometric Synthetic Aperture Radar (InSAR) to measure surface deformation caused by the Ridgecrest earthquake in July 2019.
                    </p>
                    <p class="text-gray-600 mb-4 leading-relaxed">
                        Two SAR images were processed with SNAP and SNAPHU to produce displacement results, which show displacement across the Garlock fault line exceeding one metre.
                    </p>
                    <a href="project.html?project=ridgecrest" class="text-blue-600 hover:text-blue-700 text-sm font-medium">View Project â†’</a>
                </div>
            </div>

            <!-- Project 2 -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
                <div class="aspect-video bg-gray-200">
                    <video class="w-full h-full object-cover" autoplay loop muted playsinline>
                        <source src="static/earthenginesplit.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-medium mb-1 text-gray-900">Hunga Tonga Volcanic Eruption</h3>
                    <p class="text-sm text-gray-500 mb-4">Big Earth Data</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">
                        The Hunga Tonga submarine volcano erupted in January 15, 2022. This created a caldera, which caused much of the volcano's visible landmass to disappear
                        below the ocean surface.
                    </p>
                    <p class="text-gray-600 mb-4 leading-relaxed">
                        The Google Earth Engine Widget feature was used to show the volcano before and after the eruption.
                    </p>
                    <a href="https://code.earthengine.google.com/d3908bcbab4f68ccac7da6f2c42efd73?hideCode=true" class="text-blue-600 hover:text-blue-700 text-sm font-medium">View Project â†’</a>
                </div>
            </div>

            <!-- Project 3 -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
                <div class="aspect-video bg-gray-200">
                    <video class="w-full h-full object-cover" autoplay loop muted playsinline>
                        <source src="static/spatialsimulation.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-medium mb-1 text-gray-900">Sheep Herding Simulation</h3>
                    <p class="text-sm text-gray-500 mb-4">Spatial Simulation</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">
                        Shepherd dogs herding sheep through a gate into a different pasture. The simulation was written in the GAMA programming langauge.
                        </p>
                        <p class="text-gray-600 mb-4 leading-relaxed">
                        Visualised above is an analysis of real-world flocking footage. Flock behavior can be quantified using metrics such as the convex hull area, which captures the spatial distribution of the group.</p>
                    <a href="project.html?project=simulation" class="text-blue-600 hover:text-blue-700 text-sm font-medium">View Project â†’</a>
                </div>
            </div>

            <!-- Project 4 -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
                <div class="aspect-video bg-gray-200 overflow-hidden">
                    <video class="w-full h-full object-cover" style="transform: scale(1.2);" autoplay loop muted playsinline>
                        <source src="static/poster.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-medium mb-1 text-gray-900">Interactive Flocking Poster</h3>
                    <p class="text-sm text-gray-500 mb-4">Spatial Thinking</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">This interactive web poster explores emergent behavior in sheep flocking dynamics through real-time simulation.</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">Building upon concepts from spatial simulation coursework, it demonstrates how complex collective patterns arise from simple rules, such as separation, alignment, and cohesion.</p>
                    <p class="text-gray-600 mb-4 leading-relaxed">Viewers can interact directly with the flock and adjust parameters to observe how individual behaviours can affect coordinated group movement.</p>
                    <a href="simulation.html" class="text-blue-600 hover:text-blue-700 text-sm font-medium">View Project â†’</a>
                </div>
            </div>
        </div>
    </section>

<!-- Experience Timeline Section -->
    <section class="max-w-5xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-light mb-10 text-gray-900">Experience</h2>
        
        <div class="space-y-12">
            <!-- Timeline Item 1 -->
            <div class="relative pl-8 md:pl-12 border-l-2 border-gray-200">
                <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-blue-600 border-4 border-gray-50"></div>
                <div class="mb-1 flex flex-col md:flex-row md:items-center md:justify-between">
                    <h3 class="text-xl font-medium text-gray-900">Machine Learning & Software Developer</h3>
                    <span class="text-sm text-gray-500 mt-1 md:mt-0">May 2024 - Apr 2025</span>
                </div>
                <p class="text-blue-600 font-medium mb-2">EnviroVision Solutions</p>
                <p class="text-gray-600 leading-relaxed">Developing edge computing, camera and computer vision software to aid wildfire detection and prevention.</p>
            </div>

            <!-- Timeline Item 2 -->
            <div class="relative pl-8 md:pl-12 border-l-2 border-gray-200">
                <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-blue-600 border-4 border-gray-50"></div>
                <div class="mb-1 flex flex-col md:flex-row md:items-center md:justify-between">
                    <h3 class="text-xl font-medium text-gray-900">Software Developer (IC3)</h3>
                    <span class="text-sm text-gray-500 mt-1 md:mt-0">May 2021 - Feb 2024</span>
                </div>
                <p class="text-blue-600 font-medium mb-2">Oracle Cloud</p>
                <p class="text-gray-600 leading-relaxed">Worked in complex cloud and edge computing environments across globally distributed data centers, supporting customer migrations to the cloud via the data transfer service.</p>
            </div>

            <!-- Timeline Item 3 -->
            <div class="relative pl-8 md:pl-12 border-l-2 border-gray-200">
                <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-blue-600 border-4 border-gray-50"></div>
                <div class="mb-1 flex flex-col md:flex-row md:items-center md:justify-between">
                    <h3 class="text-xl font-medium text-gray-900">Research Intern</h3>
                    <span class="text-sm text-gray-500 mt-1 md:mt-0">Dec 2020 - Jan 2021</span>
                </div>
                <p class="text-blue-600 font-medium mb-2">CAIR / University of Cape Town</p>
                <p class="text-gray-600 leading-relaxed">Created the foundation of a Cognitive Vision System (CVS) framework and developed proof-of-concept Machine Learning tools using this framework.</p>
            </div>

            <!-- Timeline Item 4 -->
            <div class="relative pl-8 md:pl-12 border-l-2 border-gray-200">
                <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-blue-600 border-4 border-gray-50"></div>
                <div class="mb-1 flex flex-col md:flex-row md:items-center md:justify-between">
                    <h3 class="text-xl font-medium text-gray-900">ML & Web App Developer</h3>
                    <span class="text-sm text-gray-500 mt-1 md:mt-0">Nov 2018 - Apr 2019</span>
                </div>
                <p class="text-blue-600 font-medium mb-2">Zomila</p>
                <p class="text-gray-600 leading-relaxed">Developed and deployed ML models using Google's ML Engine and Cloud platform. Built web applications using Angular, TypeScript and CSS.</p>
            </div>

            <!-- Timeline Item 5 -->
            <div class="relative pl-8 md:pl-12 border-l-2 border-gray-200">
                <div class="absolute -left-2 top-0 w-4 h-4 rounded-full bg-gray-300 border-4 border-gray-50"></div>
                <div class="mb-1 flex flex-col md:flex-row md:items-center md:justify-between">
                    <h3 class="text-xl font-medium text-gray-900">Python Tutor</h3>
                    <span class="text-sm text-gray-500 mt-1 md:mt-0">Feb 2018 - Jun 2018</span>
                </div>
                <p class="text-blue-600 font-medium mb-2">University of Cape Town</p>
                <p class="text-gray-600 leading-relaxed">Helped 1st year students understand and implement fundamental programming concepts using Python.</p>
            </div>
        </div>
    </section>

    <!-- Education Section -->
    <section class="max-w-5xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-light mb-10 text-gray-900">Education</h2>
        
        <div class="grid md:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow">
                <div class="text-blue-600 font-medium mb-2">Paris Lodron University</div>
                <h3 class="text-lg font-medium text-gray-900 mb-1">Copernicus Master in Digital Earth</h3>
                <p class="text-sm text-gray-500 mb-3">Oct 2025 - Present</p>
                <p class="text-sm text-gray-600">Currently enrolled</p>
            </div>

            <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow">
                <div class="text-blue-600 font-medium mb-2">University of Cape Town</div>
                <h3 class="text-lg font-medium text-gray-900 mb-1">BSc (Hons) Computer Science</h3>
                <p class="text-sm text-gray-500 mb-3">Jan 2020 - Dec 2020</p>
                <p class="text-sm text-gray-600">GPA: 82.28</p>
            </div>

            <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow">
                <div class="text-blue-600 font-medium mb-2">University of Cape Town</div>
                <h3 class="text-lg font-medium text-gray-900 mb-1">BSc Computer Science & Applied Statistics</h3>
                <p class="text-sm text-gray-500 mb-3">Feb 2017 - Nov 2019</p>
                <p class="text-sm text-gray-600">GPA: 71.39</p>
            </div>
        </div>
    </section>

    <!-- Skills Section -->
    <section class="max-w-5xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-light mb-10 text-gray-900">Skills & Technologies</h2>
        
        <div class="grid md:grid-cols-2 gap-8">
            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">Technical Expertise</h3>
                <div class="flex flex-wrap gap-2">
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">GIS</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">Computer Vision</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">Machine Learning</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">Cloud Computing</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">Virtualisation</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">System Architecture</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">CI/CD</span>
                    <span class="px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-200">Automation Testing</span>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">Technologies & Tools</h3>
                <div class="flex flex-wrap gap-2">
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">QGIS</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Snap</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">eCognition</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">ArcGIS</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">PyTorch</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">OpenCV</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">FFmpeg</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Docker</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Linux</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Ansible</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Terraform</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Kafka</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Jenkins</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">Git</span>
                    <span class="px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full border border-green-200">QEMU</span>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">Programming Languages</h3>
                <div class="flex flex-wrap gap-2">
                    <span class="px-3 py-1 bg-purple-50 text-purple-700 text-sm rounded-full border border-purple-200">Golang</span>
                    <span class="px-3 py-1 bg-purple-50 text-purple-700 text-sm rounded-full border border-purple-200">Python</span>
                    <span class="px-3 py-1 bg-purple-50 text-purple-700 text-sm rounded-full border border-purple-200">JavaScript</span>
                    <span class="px-3 py-1 bg-purple-50 text-purple-700 text-sm rounded-full border border-purple-200">Java</span>
                </div>
            </div>

            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">Achievements</h3>
                <div class="space-y-3">
                    <div class="flex items-start">
                        <div class="w-2 h-2 bg-blue-600 rounded-full mt-2 mr-3"></div>
                        <div>
                            <p class="text-sm font-medium text-gray-900">Meta/Facebook Software Engineer Mentee</p>
                            <p class="text-xs text-gray-500">Africa Mentorship Programme (May - Dec 2019)</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="w-2 h-2 bg-blue-600 rounded-full mt-2 mr-3"></div>
                        <div>
                            <p class="text-sm font-medium text-gray-900">EY Data Science Competition Finalist</p>
                            <p class="text-xs text-gray-500">South African Finalist, NextWave Challenge (Apr - Jun 2019)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Map Section -->
    <section class="max-w-5xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-light mb-10 text-gray-900">Location</h2>
        
        <div class="bg-white rounded-lg border border-gray-200 p-2 shadow-sm relative">
            <div id="map" class="w-full h-96 rounded-md"></div>
            
<!-- Dropdown menu in bottom-left corner -->
<div class="absolute bottom-6 left-6 z-[1000] group">
    <button class="bg-white/90 hover:bg-white border border-gray-300 text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md shadow-sm hover:shadow-md transition-all flex items-center gap-2 text-xs">
        <span class="font-medium">View more</span>
        <svg class="w-3 h-3 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
    </button>
    
    <!-- Dropdown menu -->
    <div class="hidden group-hover:block absolute bottom-full left-0 mb-2 w-48 bg-white border border-gray-300 rounded-md shadow-lg overflow-hidden">
        <a href="salzburg.html" class="block px-4 py-3 hover:bg-gray-50 transition-colors border-b border-gray-100">
            <div class="flex items-center gap-3">
                <span class="text-lg">ðŸ“¸</span>
                <div>
                    <div class="font-medium text-gray-900 text-sm">Photo Journey</div>
                    <div class="text-xs text-gray-500">Explore my photo map</div>
                </div>
            </div>
        </a>
        <a href="adventure-map.html" class="block px-4 py-3 hover:bg-gray-50 transition-colors">
            <div class="flex items-center gap-3">
                <span class="text-lg">ðŸš´</span>
                <div>
                    <div class="font-medium text-gray-900 text-sm">Cycling Adventures</div>
                    <div class="text-xs text-gray-500">Random destinations</div>
                </div>
            </div>
        </a>
    </div>
</div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
        <div class="max-w-5xl mx-auto px-6 py-8">

            <!-- Logo Row -->
            <div class="flex justify-center items-center gap-8 mb-6 flex-wrap">
                <img src="static/cofunded.png" alt="Cofunded Logo" class="h-10 object-contain">
                <img src="static/corpernicus.png" alt="Copernicus Logo" class="h-10 object-contain">
                <img src="static/plus.png" alt="Plus Logo" class="h-10 object-contain">
                <img src="static/ubs.png" alt="UBS Logo" class="h-10 object-contain">
            </div>

            <!-- Footer text -->
            <p class="text-gray-600 text-sm text-center">
                Â© 2025 Timothy Simons. All rights reserved.
            </p>
        </div>
    </footer>


<script>
    // Three.js terrain setup
    const canvas = document.getElementById('terrain-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / 400, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    
    function resizeRenderer() {
        const header = canvas.parentElement;
        renderer.setSize(header.offsetWidth, header.offsetHeight);
        camera.aspect = header.offsetWidth / header.offsetHeight;
        camera.updateProjectionMatrix();
    }
    resizeRenderer();
    window.addEventListener('resize', resizeRenderer);

    function loadHeightmapTerrain(imageUrl) {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = function() {
            const canvas2d = document.createElement('canvas');
            const ctx = canvas2d.getContext('2d');
            const width = 128;
            const height = 128;
            canvas2d.width = width;
            canvas2d.height = height;
            ctx.drawImage(img, 0, 0, width, height);
            const imgData = ctx.getImageData(0, 0, width, height);
            const pixels = imgData.data;
            
            // Create terrain geometry
            const geometry = new THREE.PlaneGeometry(20, 20, width - 1, height - 1);
            const vertices = geometry.attributes.position.array;
            
            // Create color array for vertex colors
            const colors = new Float32Array(vertices.length);
            
            // Track min/max heights for normalization
            let minHeight = Infinity;
            let maxHeight = -Infinity;
            
            // Apply height data from the heightmap
            for (let i = 0, j = 0; i < vertices.length; i += 3, j++) {
                const pixelIndex = j * 4;
                const heightValue = pixels[pixelIndex] / 255;
                const height = heightValue * 5 - 2.5;
                vertices[i + 2] = height;
                
                minHeight = Math.min(minHeight, height);
                maxHeight = Math.max(maxHeight, height);
            }
            
            // Apply colors based on normalized height
            for (let i = 0, j = 0; i < vertices.length; i += 3, j++) {
                const height = vertices[i + 2];
                // Normalize height between 0 and 1
                const normalizedHeight = (height - minHeight) / (maxHeight - minHeight);
                
                // Create soft gradient: soft blue (low) -> teal -> coral -> soft pink/peach (high)
                const color = new THREE.Color();
                if (normalizedHeight < 0.33) {
                    // Soft blue to teal
                    color.lerpColors(
                        new THREE.Color(0x6B9BD1), // Soft blue
                        new THREE.Color(0x4DB8B8), // Teal
                        normalizedHeight * 3
                    );
                } else if (normalizedHeight < 0.66) {
                    // Teal to coral
                    color.lerpColors(
                        new THREE.Color(0x4DB8B8), // Teal
                        new THREE.Color(0xF4A261), // Coral/orange
                        (normalizedHeight - 0.33) * 3
                    );
                } else {
                    // Coral to soft pink/peach
                    color.lerpColors(
                        new THREE.Color(0xF4A261), // Coral
                        new THREE.Color(0xE76F51), // Soft red/pink
                        (normalizedHeight - 0.66) * 3
                    );
                }
                
                colors[j * 3] = color.r;
                colors[j * 3 + 1] = color.g;
                colors[j * 3 + 2] = color.b;
            }
            
            // Add colors to geometry
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geometry.computeVertexNormals();
            
            // Create filled mesh with high transparency (gradient colors)
            const fillMaterial = new THREE.MeshBasicMaterial({
                vertexColors: true,
                transparent: true,
                opacity: 0.1,  // Slightly more visible for soft colors
                side: THREE.DoubleSide
            });
            
            // Create wireframe with solid lines and gradient colors
            const wireframeMaterial = new THREE.MeshBasicMaterial({
                vertexColors: true,  // Use gradient colors
                wireframe: true,
                transparent: false,  // Solid lines
                opacity: 0.82
            });
            
            // Create both meshes
            const terrainFill = new THREE.Mesh(geometry, fillMaterial);
            const terrainWireframe = new THREE.Mesh(geometry.clone(), wireframeMaterial);
            
            // Group them together
            const terrainGroup = new THREE.Group();
            terrainGroup.add(terrainFill);
            terrainGroup.add(terrainWireframe);
            terrainGroup.rotation.x = -Math.PI / 2.5;
            
            scene.add(terrainGroup);
            
            camera.position.set(0, 2.8, 5.5);
            camera.lookAt(0, 0, 0);
            
            function animate() {
                requestAnimationFrame(animate);
                terrainGroup.rotation.z += 0.001;
                renderer.render(scene, camera);
            }
            animate();
        };
        
        img.onerror = function() {
            console.log('Could not load heightmap, using procedural terrain');
            // createProceduralTerrain();
        };
        img.src = imageUrl;
    }

    loadHeightmapTerrain('static/terrain.png');
    
    // Initialize the map with default view
    const map = L.map('map').setView([47.5, 13], 8);
    
    // Add tile layer with a clean, minimal style
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
        maxZoom: 19
    }).addTo(map);

    // Custom marker icon (camera icon style)
    const photoIcon = L.divIcon({
        className: 'photo-marker',
        html: '<div style="background: #e74c3c; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
        iconSize: [16, 16],
        iconAnchor: [8, 8]
    });

    let heatLayer, markersLayer;
    let currentGeoJSONData;

    // Function to load and display GeoJSON data
    function loadGeoJSON(geojsonData) {
        currentGeoJSONData = geojsonData;

        // Find the most recent photo date
        let latestDate = null;
        let photoCount = geojsonData.features.length;
        
        geojsonData.features.forEach(feature => {
            if (feature.properties.date) {
                // Handle different date formats
                let dateStr = feature.properties.date;
                // Remove any timezone info and clean up
                dateStr = dateStr.split('+')[0].split('Z')[0].trim();
                // Replace colons with dashes in date part only (YYYY:MM:DD to YYYY-MM-DD)
                dateStr = dateStr.replace(/^(\d{4}):(\d{2}):(\d{2})/, '$1-$2-$3');
                
                const date = new Date(dateStr);
                if (!isNaN(date.getTime()) && (!latestDate || date > latestDate)) {
                    latestDate = date;
                }
            }
        });

        // Format the date nicely
        const formattedLatestDate = latestDate && !isNaN(latestDate.getTime())
            ? latestDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
            : 'Unknown';

        // Add custom control to show photo count and latest date
        const info = L.control({ position: 'topright' });
        info.onAdd = function() {
            const div = L.DomUtil.create('div', 'map-info-control');
            div.innerHTML = `
                <strong>ðŸ“¸ ${photoCount} photos from my reel</strong>
                <br>
                <small>Last Updated: ${formattedLatestDate}</small>
            `;
            return div;
        };
        info.addTo(map);

        // Prepare heatmap data: [lat, lng, intensity]
        const heatData = geojsonData.features.map(feature => [
            feature.geometry.coordinates[1], // lat
            feature.geometry.coordinates[0], // lng
            1 // intensity
        ]);

        // Create heatmap layer
        heatLayer = L.heatLayer(heatData, {
            radius: 25,
            blur: 15,
            maxZoom: 13,
            max: 1.0,
            gradient: {
                0.0: '#3388ff',
                0.3: '#44bb44', 
                0.5: '#ffff00',
                0.7: '#ff8800',
                1.0: '#ff0000'
            }
        }).addTo(map);

        // Create markers layer (initially hidden)
        markersLayer = L.layerGroup();
        L.geoJSON(geojsonData, {
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, { icon: photoIcon });
            },
            onEachFeature: function(feature, layer) {
                const props = feature.properties;
                const fileName = props.file ? props.file.split('/').pop() : 'Unknown';
                const formattedDate = props.date ? props.date.replace(/:/g, '-').substring(0, 10) : 'No date';
                layer.bindPopup(`
                    <div style="min-width: 150px;">
                        <strong>ðŸ“· ${formattedDate}</strong><br>
                    </div>
                `);
            }
        }).addTo(markersLayer);

        // Switch between heatmap and markers based on zoom level
        function updateVisualization() {
            const zoom = map.getZoom();
            if (zoom > 13) {
                if (!map.hasLayer(markersLayer)) {
                    map.removeLayer(heatLayer);
                    map.addLayer(markersLayer);
                }
            } else {
                if (!map.hasLayer(heatLayer)) {
                    map.removeLayer(markersLayer);
                    map.addLayer(heatLayer);
                }
            }
        }

        map.on('zoomend', updateVisualization);
        updateVisualization();

        // Fit map bounds to show all markers
        const bounds = L.latLngBounds(
            geojsonData.features.map(f => [f.geometry.coordinates[1], f.geometry.coordinates[0]])
        );
        map.fitBounds(bounds, { padding: [50, 50] });
    }

    // Try to fetch the GeoJSON file from static folder
    fetch('static/photos.geojson')
        .then(response => {
            if (!response.ok) {
                throw new Error('GeoJSON file not found');
            }
            return response.json();
        })
        .then(geojsonData => {
            loadGeoJSON(geojsonData);
        })
        .catch(error => {
            console.error('Error loading GeoJSON:', error);
            // Add a message on the map
            L.popup()
                .setLatLng([47.5, 13])
                .setContent('<b>Could not load photos.geojson</b><br>Make sure the file is in the static/ directory.')
                .openOn(map);
        });
</script>

</body>
</html>